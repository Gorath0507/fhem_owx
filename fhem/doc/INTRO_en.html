<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html style="margin:0;overflow:visible;border:none;">
    <head>
        <title></title>
    </head>
    <body style="border:none;overflow:visible;">
        <h3>Introduction</h3>
        <ul> Fhem is mainly used for home automation, but it is suitable for other tasks too, where
            notification, timers and logging plays an important role.<br />
            <br /> It supports different hardware devices to interface with certain protocols (e.g.
            FHZ1000 to interface FS20 and HMS, CM11 to access X10), and logical devices like FS20 or
            FHT to digest the messages for a certain device type using this protocol.<br />
            <br /> Fhem is modular. The different devices are represented through modules which
            implement certain functions (e.g. define, get, set). Even seemingly integral parts of
            fhem like triggers (<a href="#notify">notify</a>) and timers (<a href="#at">at</a>) are
            implemented this way, giving the possibility to replace/extend this functionality.<br />
            <br /> Fhem is controlled through readable / ascii commands, which are specified in
            files (e.g. the configuration file), or issued over a TCP/IP connection, either directly
            in a telnet session, with a fhem.pl in client mode or from one of the web frontends.<br />
            <br /> When starting the server you have to specify a configuration file:<br />
            <ul>
                <code>fhem.pl ~/.fhem</code>
            </ul>
            <br /> A minimal configuration file:
            <pre>
    attr global <a href="#logfile">logfile</a> /tmp/fhem.log
    attr global <a href="#statefile">statefile</a> /tmp/fhem.save
    attr global <a href="#verbose">verbose</a> 3
    attr global <a href="#port">port</a> 7072
    attr global <a href="#modpath">modpath</a> /usr/share/fhem
    <a href="#define">define</a> FHZ FHZ /dev/tts/USB0

    <a href="#define">define</a> lamp FS20 8765 01</pre>
            For other configuration files see the examples subdirectory.<br />
            <br /> TCP/IP communication with fhem can either happen in a "session" (via telnet) or
            single client command (via fhem.pl). Example: <ul>
                <code>telnet localhost 7072<br /> &lt;NL&gt; </code>(This newline switches into
                "prompt" mode)<code><br /> &lt;command&gt;...<br /> quit</code><br />
            </ul> or <ul>
                <code>fhem.pl 7072 "set lamp off"</code>
            </ul>
        </ul>


        <a name="command"></a>
        <h3>Fhem command types</h3>
        <ul> There are three types of commands: "fhem" commands (described in this document), shell
            commands (they must be enclosed in double quotes ") and perl expressions (enclosed in
            curly brackets {}). shell commands or perl expressions are needed for complex <a
                href="#at">at</a> or <a href="#notify">notify</a> arguments, but can also issued as
            a "normal" command.<br />
            <br /> E.g. the following three commands all do the same when issued from a telnet prompt:<br />
            <ul> set lamp off<br /> "fhem.pl 7072 "set lamp off""<br /> {fhem("set lamp off")}<br />
            </ul>
            <br /> Shell commands will be executed in the background, perl expressions and fhem
            commands will be executed in the main "thread". In order to make perl expressions easier
            to write, some special functions and variables are available. See the section <a
                href="#perl">Perl special</a> for a description. To trigger fhem commands from a
            shell script (this is the "other way round"), use the client form of fhem.pl (described above).<br />
            <br /> Multiple fhem commands are separated by semicolon (;). In order to use semicolon
            in perl code or shell programs, they have to be escaped by the double semicolon (;;).
            See the <b>Notes</b> section of the <a href="#notify">notify</a> chapter on command
            parameters and escape rules.<br /> E.g. the following first command switches Lamp1 off
            at 07:00 and Lamp2 immediately (at the point of definition), the second one switches
            both lamps off at 07:00.<br />
            <ul> define lampoff at 07:00 set Lamp1 off; set Lamp2 off<br /> define lampoff at 07:00
                set Lamp1 off;; set Lamp2 off<br />
            </ul>
            <br /> Commands can be either typed in plain, or read from a file (e.g. the
            configuration file at startup). The commands are either executed directly, or later if
            they are arguments to the <a href="#at">at</a> and <a href="#notify">notify</a> fhem commands.<br />
            <br /> A line ending with \ will be concatenated with the next one, so long lines (e.g.
            multiple perl commands) can be split in multiple lines. Some web fronteds (e.g. webpgm2)
            make editing of multiline commands transparent for you (i.e. there is no need for \) .<br />
            <br />
        </ul>


        <a name="devspec"></a>
        <h3>Device specification (devspec)</h3>
        <ul> The commands <a href="#attr">attr</a>, <a href="#deleteattr">deleteattr</a>, <a
                href="#delete">delete</a>, <a href="#get">get</a>, <a href="#list">list</a>, <a
                href="#set">set</a>, <a href="#setstate">setstate</a>, <a href="#trigger"
                >trigger</a> can take a more complex device specification as argument, which will be
            expanded to a list of devices. A device specification (short devspec) can be: <ul>
                <li>a single device name. This is the most common case.</li>
                <li>a list of devices, separated by comma (,)</li>
                <li>a range of devices, separated by dash (-)</li>
                <li>a regular expression, if the the spec contains on e of the following characters:
                    ^*[]$</li>
                <li>an attribute of the device, followed by an equal sign (=) and then a regexp for
                    this attribute. As attribute you can specify either attributes set with the attr
                    command or one of the "internal" attributes DEF, STATE and TYPE.</li>
            </ul> Example: <ul>
                <code>set lamp1 on</code><br />
                <code>set lamp1,lamp2,lamp3 on</code><br />
                <code>set lamp[1-3] on</code><br />
                <code>set lamp.* on</code><br />
                <code>set lamp1-lamp3 on</code><br />
                <code>set lamp1-lamp3,lamp3 on</code><br />
                <code>set room=kitchen off</code><br />
                <code>list disabled=</code><br />
                <code>list TYPE=FS20</code><br />
            </ul> Notes: <ul>
                <li>first the spec is separated by komma, then the range or the regular expression
                    operations are executed.</li>
                <li>if there is a device which exactly corresponds to the spec, then no special
                    processing is done.</li>
                <li>the returned list can contain the same device more than once, so "set
                    lamp1-lamp3,lamp3 on" switches lamp3 twice.</li>
                <li>for more complex structuring demands see the <a href="#structure"> structure</a>
                    device.</li>
            </ul>
        </ul>
    </body>
</html>
